---
import SproutIcon from "./SproutIcon.astro";
import BranchDecor from "./BranchDecor.astro";
---

<footer class="border-t-4 py-6 relative overflow-hidden" style="border-color: var(--color-dark); background-color: oklch(from var(--color-surface) calc(l - 0.03) c h);">
  <!-- Botanical accent -->
  <div class="absolute bottom-[-20px] left-[6%] opacity-15 pointer-events-none" style="transform: rotate(170deg);">
    <BranchDecor size={140} variant={4} class="text-[var(--color-accent)]" />
  </div>

  <div class="mx-auto max-w-6xl px-6 relative z-10">
    <div class="flex items-center justify-between">
      <div class="flex items-center gap-3">
        <SproutIcon size={24} />
        <span class="font-display text-xl font-bold" style="color: var(--color-dark);">Holophyte</span>
      </div>

      <div id="theme-switcher" class="flex items-center gap-1">
        <button data-theme="coral" class="active"><span class="swatch" style="background:#2E6E5E"></span><span class="swatch" style="background:#E06858"></span><span class="swatch" style="background:#F0A87A"></span></button>
        <button data-theme="terracotta"><span class="swatch" style="background:#5A6D5A"></span><span class="swatch" style="background:#D97D54"></span><span class="swatch" style="background:#E8B44D"></span></button>
        <button data-theme="tropical"><span class="swatch" style="background:#10B183"></span><span class="swatch" style="background:#E36D9B"></span><span class="swatch" style="background:#E7DD6A"></span></button>
      </div>

      <div class="flex items-center gap-4">
        <p class="font-display text-sm text-muted tracking-wide">MADE BY KO</p>
        <div class="h-4 w-px" style="background: oklch(from var(--color-dark) l c h / 0.2);"></div>
        <p class="text-sm text-muted">2026</p>
      </div>
    </div>
  </div>
</footer>

<style>
  #theme-switcher button {
    padding: 4px 8px;
    border: 1px solid transparent;
    border-radius: 6px;
    background: transparent;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 4px;
  }

  #theme-switcher button:hover {
    border-color: oklch(from var(--color-dark) calc(l + 0.15) c h);
  }

  #theme-switcher button.active {
    border-color: var(--color-dark);
  }

  .swatch {
    display: inline-block;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    flex-shrink: 0;
  }
</style>

<script>
  /*
   * Theme switcher â€” only 5 base colors per theme.
   * All derived shades (cream-dark, sage-dark, brown-light, text, text-muted)
   * are computed via CSS relative colors in global.css, so we never
   * need to ship or switch those manually.
   */
  const themes: Record<string, Record<string, string>> = {
    coral: {
      '--color-primary':   '#2E6E5E',
      '--color-accent':    '#E06858',
      '--color-highlight': '#F0A87A',
      '--color-dark':      '#3A2E2A',
      '--color-surface':   '#FAF7F4',
    },
    terracotta: {
      '--color-primary':   '#5A6D5A',
      '--color-accent':    '#D97D54',
      '--color-highlight': '#E8B44D',
      '--color-dark':      '#3D2817',
      '--color-surface':   '#F9F6F0',
    },
    tropical: {
      '--color-primary':   '#10B183',  /* Emerald   */
      '--color-accent':    '#E36D9B',  /* Watermelon */
      '--color-highlight': '#E7DD6A',  /* Canary     */
      '--color-dark':      '#2B4789',  /* Royal Blue */
      '--color-surface':   '#F5F7F2',  /* soft warm white with a green lean */
    },
  };

  const root = document.documentElement;
  const buttons = document.querySelectorAll('#theme-switcher button');

  buttons.forEach((btn) => {
    btn.addEventListener('click', () => {
      const themeName = (btn as HTMLElement).dataset.theme!;
      const theme = themes[themeName];

      for (const [prop, value] of Object.entries(theme)) {
        root.style.setProperty(prop, value);
      }

      buttons.forEach((b) => b.classList.remove('active'));
      btn.classList.add('active');
    });
  });
</script>
